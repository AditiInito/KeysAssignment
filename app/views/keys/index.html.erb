<%=link_to "Generate new key", keys_path, class: "btn btn-success", method: :post%>
<%=link_to "Assign a key", random_keys_path, class: "btn btn-success", method: :post%>

<div class="flickr_pagination">
    <%= will_paginate @keys, :container => false %>
</div>
<table class="table table-striped table-dark">
  <thead>
    <tr>
      <th scope="col">ID</th>
      <th scope="col">Key</th>
      <th scope="col">Used</th>
      <th scope="col">Created At</th>
      <th scope="col">Updated At</th>
      <th scope="col">Called At</th>
      <th scope="col">Revived At</th>
      <th scope="col">Actions</th>
    </tr>
  </thead>
  <tbody>
    
    <% @keys.each do |key| %>
        <tr>
            <td><%= key.id %></td>
            <td><%= key.key %></td>
            <td><%= key.used %></td>
            <td><%= format_time_in_kolkata(key.created_at) %></td>
            <td><%= format_time_in_kolkata(key.updated_at) %></td>
            <td><%= format_time_in_kolkata(key.called_at) %></td>
            <td><%= format_time_in_kolkata(key.revived_at) %></td>
            <td>
                <%=link_to "Delete", key_path(key), class: "mr-4", method: :delete, data: {confirm: "Are you sure?"}%>
                <%=link_to "Keep alive", keys_revived_at_key_path(key), class: "mr-4", method: :put%>
                <% if key.used %>
                    <%=link_to "Unblock", keys_called_at_key_path(key), class: "mr-4", method: :put%>
                <% end %>
            </td>
        </tr>
    <%end%>

  </tbody>
</table>
<div class="flickr_pagination">
    <%= will_paginate @keys, :container => false %>
</div>
